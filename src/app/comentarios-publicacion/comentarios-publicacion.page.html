<app-navbar></app-navbar>

<!-- PUBLICACION -->

<ion-content>
  <ion-card class="card-text" *ngIf="boolEsTexto">
    <ion-label class="inner-text texto">{{ publicacionObs.value.contenido }}</ion-label>
  </ion-card>

  <ion-card class="card" *ngIf="boolEsFoto">
    <img id="foto" src="{{publicacionObs.value.contenido}}">
  </ion-card>

  <ion-card class="card" *ngIf="boolEsEnlace">
    <ion-card-header>
      <ion-card-title [innerHtml]="preview.title"></ion-card-title>
      <img [src]="preview.image">
    </ion-card-header>
    <ion-card-content [innerHtml]="preview.description"></ion-card-content>
  </ion-card>

  <ion-card class="card reacciones" *ngIf="boolEsTexto || boolEsFoto || boolEsEnlace">
    <ion-button (click)="reaccionarAPublicacion('MeGusta')" fill="clear" size="small">
      <ion-icon name="thumbs-up-outline" slot="start"></ion-icon>
      {{publicacionObs.value.cantidadLikes}}
    </ion-button>

    <ion-button (click)="reaccionarAPublicacion('NoMeGusta')" fill="clear" size="small">
      <ion-icon name="thumbs-down-outline" slot="start"></ion-icon>
      {{publicacionObs.value.cantidadDislikes}}
    </ion-button>
  </ion-card>

  <!-- AGREGAR COMENTARIO -->

  <ion-card style="background-color: white;">
    <ion-card-content>
      <form [formGroup]="comentarioForm" (ngSubmit)="aniadirComentarioAPublicacion()">
        <ion-item>
          <ion-textarea placeholder="Comenta algo" required formControlName="comentario" type="text"></ion-textarea>
        </ion-item>
        <ion-button style="float: right;" block color="primary" type="submit" [disabled]="comentarioForm.invalid">
          Comentar
        </ion-button>
      </form>
    </ion-card-content>
  </ion-card>

  <!-- COMENTARIOS  -->
  <ion-card class="card" *ngIf="boolVerComentarios">
    <ion-card-header class="header">Mis Comentarios</ion-card-header>
    <ion-list>
      <ion-item *ngFor="let comentario of comentariosReaccionesObs | async">
        <ion-grid fixed>
          <ion-row>
            <ion-col size="10">
              <ion-label class="texto" text-wrap *ngIf="comentario.idComentarioPadre === null"> {{ comentario.contenido }}
              </ion-label>
              <ion-label text-wrap style="padding-left: 8%;" *ngIf="comentario.idComentarioPadre !== null"> {{
                comentario.contenido }} </ion-label>
            </ion-col>
            <ion-col size="2">
              <ion-icon class="edit-publicacion-icon" (click)="presentPopover( $event, comentario )" name="ellipsis-horizontal-circle-outline"></ion-icon>
              <!-- <ion-button (click)="modificarComentario(comentario)" *ngIf="comentario.idPersona === userId" fill="clear"
                color="medium" size="small">
                <ion-icon name="create" slot="start"></ion-icon>
              </ion-button>

              <ion-button (click)="eliminarComentario(comentario.idComentario)" *ngIf="comentario.idPersona === userId"
                fill="clear" color="medium" size="small">
                <ion-icon name="trash" slot="start"></ion-icon>
              </ion-button> -->
            </ion-col>

          </ion-row>
          <ion-row>
            <ion-col size="12">
              <ion-button (click)="reaccionarComentario(comentario, 'MeGusta')" fill="clear" size="small">
                <ion-icon name="thumbs-up-outline" slot="start"></ion-icon>
                {{comentario.cantidadLikes}}
              </ion-button>

              <ion-button (click)="reaccionarComentario(comentario, 'NoMeGusta')" fill="clear" size="small">
                <ion-icon name="thumbs-down-outline" slot="start"></ion-icon>
                {{comentario.cantidadDislikes}}
              </ion-button>

              <ion-button (click)="aniadirComentarioAComentario(comentario)" fill="clear" size="small"
                *ngIf="comentario.idComentarioPadre === null">
                <ion-icon name="chatbubble-outline" slot="start"></ion-icon>
                {{comentario.comentariosHijos.length}}
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list>
  </ion-card>

</ion-content>